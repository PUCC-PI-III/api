import fastifyMultipart from "@fastify/multipart";
import fastify from "fastify";

function getMonday(dateInput) {
  let mondayWeek;
  if (dateInput) {
    mondayWeek = new Date(dateInput); //cria um objeto Date com a data recebida
  } else {
    mondayWeek = new Date(Date.now()); //cria um objeto Date com a data atual
  }
  let monday = mondayWeek.getDay(); //determina o dia da semana(0-6) da data recebida
  if (monday === 0) monday = 7; //se for domingo, define como 7 para facilitar o cálculo
  if (monday !== 1) {
    //se não for segunda-feira
    mondayWeek.setHours(-24 * (monday - 1)); //subtrai o número de horas correspondente aos dias até a segunda-feira
  }
  let year = mondayWeek.getFullYear(); //pega o ano da data
  let month = String(mondayWeek.getMonth() + 1).padStart(2, "0"); //determina o mês da data e formata para ter dois dígitos
  let dayW = String(mondayWeek.getDate()).padStart(2, "0"); //determina o dia do mês da data e formata para ter dois dígitos
  var formattedMonday = `${year}-${month}-${dayW} 00:00:00`; //define a data formatada como string no formato 'YYYY-MM-DD HH:MM:SS'

  return formattedMonday;
} //amamos código reaproveitado
function getSunday(dateInput) {
  let sundayWeek;
  if (dateInput) {
    sundayWeek = new Date(dateInput);
  } else {
    sundayWeek = new Date(Date.now());
  }
  let sunday = sundayWeek.getDay();
  if (sunday != 0) {
    sundayWeek.setHours(-24 * (sunday - 7)); //se não for domingo, subtrai o número de horas correspondente aos dias até o domingo
  }
  let year = sundayWeek.getFullYear(); //pega o ano da data
  let month = String(sundayWeek.getMonth() + 1).padStart(2, "0"); //determina o mês da data e formata para ter dois dígitos
  let dayW = String(sundayWeek.getDate()).padStart(2, "0"); //determina o dia do mês da data e formata para ter dois dígitos
  var formattedSunday = `${year}-${month}-${dayW} 23:59:59`; //formata a data como string no formato 'YYYY-MM-DD HH:MM:SS'
  return formattedSunday; //retorna a data formatada
}

export default async function (fastify) {
  fastify.register(fastifyMultipart);
  //cria a rota tipo POST de riscos, responsável pelo cadastro de riscos
  fastify.post("/riscos", async (req, reply) => {
    const db = fastify.mongo.client.db("projetoI"); //determina o database
    const riscos = db.collection("riscos"); //determina a collection

    try {
      const data = await req.file(); //determina que 'data' equivale ao valor recebido na chamada de req.file, método da lib 'multer' para receber arquivos
      const tit = data.fields.titulo.value; //titulo(propriedade de 'riscos')
      const obs = data.fields.obs.value; //observações(propriedade de 'riscos')
      const date = new Date(); // cria um objeto Date do JS
      const localizacao = data.fields.localizacao.value; //localização(propriedade de 'riscos')
      var status = false; //se está resolvido ou não

      const buffoon = await data.toBuffer(); //converte os dados para tipo binário através do método 'toBuffer' e armazena na constante 'buffoon'(balatro mencionado)
      const b64 = buffoon.toString("base64"); //converte a constante em buffoon para base64

      const newRisk = await riscos.insertOne({
        tit,
        obs,
        localizacao,
        date,
        imagem: b64,
        status,
      });

      reply.code(201).send(newRisk); //retorna sucesso e envia o resultado da operacao
    } catch (err) {
      reply.code(500).send({ error: err.message }); //retorna erro
    }
  });

  fastify.get("/riscos/:id", async (req, reply) => {
    const db = fastify.mongo.client.db("projetoI");
    const riscos = db.collection("riscos");

    try {
      const { id } = req.params;
      const risk = await riscos.findOne({
        _id: new fastify.mongo.ObjectId(id),
      });

      if (!risk) {
        reply.code(404).send({ error: "Risco não encontrado." });
        return;
      }

      const buffoon = Buffer.from(risk.imagem, "base64");

      /*reply.header('Content-Type', 'application/json').send({
                titulo: risk.tit,
                obs: risk.obs,
                localizacao: risk.localizacao,
                imagem: buffoon.toString('base64') 
            });*/
      reply.header("Content-Type", "image/png").send(buffoon);
    } catch (err) {
      reply.code(500).send({ error: err.message });
    }
  });

  fastify.get("/riscos", async function (req, reply) {
    const db = this.mongo.client.db("projetoI");
    const riscos = db.collection("riscos");
    try {
      const allRiscos = riscos
        .find(
          {},
          {
            projection: {
              _id: 1,
              tit: 1,
              obs: 1,
              localizacao: 1,
              date: 1,
              status: 1,
              imagem: 1,
            },
          }
        )
        .toArray();
      return allRiscos;
    } catch (err) {
      return { error: err.message };
    }
  });

  fastify.get("/riscosnoimage", async function (req, reply) {
    const db = this.mongo.client.db("projetoI");
    const riscos = db.collection("riscos");
    try {
      const allRiscos = riscos
        .find(
          {},
          {
            projection: {
              _id: 1,
              tit: 1,
              obs: 1,
              localizacao: 1,
              date: 1,
              status: 1,
            },
          }
        )
        .toArray();
      return allRiscos;
    } catch (err) {
      return { error: err.message };
    }
  });

  //Rotas referentes ao segundo aplicativo

  fastify.get("/relatoriosemanal", async function (req, reply) {
    //retorna riscos registrados naquela semana
    const db = this.mongo.client.db("projetoI");
    const riscos = db.collection("riscos");
    const date = new Date(Date.now());
    try {
      const monday = new Date(getMonday(date));
      const sunday = new Date(getSunday(date));
      const relatorio = await riscos
        .find(
          { date: { $gte: monday, $lte: sunday } },
          {
            projection: {
              _id: 1,
              tit: 1,
              obs: 1,
              localizacao: 1,
              date: 1,
              status: 1,
            },
          } //filtra pra nao retornar imagem (ela ta em b64 ta bem feinha :3)
        )
        .toArray();
      reply.code(200).send(relatorio);
    } catch (err) {
      return { error: err.message };
    }
  });

  fastify.get("/open", async function (_, reply) {
    //retorna riscos abertos(não resolvidos)
    const db = this.mongo.client.db("projetoI");
    const riscos = db.collection("riscos");
    try {
      const abertos = await riscos
        .find(
          { status: false },
          { projection: { _id: 1, tit: 1, obs: 1, localizacao: 1, date: 1 } }
        )
        .toArray();
      reply.code(200).send(abertos);
    } catch (err) {
      return { error: err.message };
    }
  });
  fastify.get("/relatoriomensal", async function (_, reply) {
    const db = this.mongo.client.db("projetoI");
    const riscos = db.collection("riscos");
    try {
      const now = new Date();
      /*const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);
      const endOfMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0, 23, 59, 59);

      const allRiscos = await riscos
        .find(
          { date: { $gte: startOfMonth, $lte: endOfMonth } },
          { projection: { _id: 1, tit: 1, obs: 1, localizacao: 1, date: 1 } }
        )
        .toArray();


        o código comentado serve para que os relatórios busquem apenas os riscos no mês(talvez fique talvez nao :3)
*/
      const allRiscos = await riscos
        .find(
          {},
          { projection: { _id: 1, tit: 1, obs: 1, localizacao: 1, date: 1 } }
        )
        .toArray(); //busca todos os documentos e retorna o id, o titulo, observações, localização e data
      const semanas = [];

      allRiscos.forEach((item) => {
        //para cada item
        const monday = getMonday(item.date); //define a segunda da semana daquele dia
        const sunday = getSunday(item.date); //define o domingo da semana daquele dia
        const range = `${monday} - ${sunday}`; //determina que a semana vai da segunda até o domingo

        let semana = semanas.find((ordena) => ordena.week === range); //procura se já existe uma semana com o mesmo intervalo de datas
        if (!semana) {
          semana = { week: range, riscos: [] }; //determina que o array 'semana'(que vai ser retornado pela rota)
          // contém o elemento 'week'(que determina o 'range') e um array para armazenar os riscos
          semanas.push(semana); //armazena a semana no array 'semanas'
        }
        semana.riscos.push(item); //adiciona o risco do item no array de riscos daquela semana
      });

      semanas.sort((a, b) => {
        const [comeco1] = a.week.split(" - ");
        const [comeco2] = b.week.split(" - ");
        return new Date(comeco1) - new Date(comeco2);
      }); //ordena as semanas pelo começo da semana e retorna o array de semanas ordenado

      reply.code(200).send(semanas); //retorna o array de semanas ordenado
    } catch (err) {
      return { error: err.message };
    }
  });

  fastify.patch("/atualiza", async function (req, reply) {
    const db = this.mongo.client.db("projetoI");
    const riscos = db.collection("riscos");
    try {
      const idRisco = req.body._id; //define idRisco como o '_id' do documento
      const id = new this.mongo.ObjectId(idRisco); //cria uma variavel 'id' que recebe um ObjectId(classe do _id) com o valor de idRisco
      const update = await riscos.updateOne(
        { _id: id }, //pega o id do documento
        { $set: { status: true } } //define o status(se está resolvido ou não) para verdadeiro(resolvido)
      );
      reply.code(200).send(update); //retorna o resultado da operação de update
    } catch (err) {
      reply.code(500).send({ error: err.message });
    }
  });
  fastify.delete("/deletar", async function (req, reply) {
    //so pra deletar os 800 risco de teste mais rapido
    const db = this.mongo.client.db("projetoI");
    const riscos = db.collection("riscos");
    try {
      const idRisco = req.body._id;
      const id = new this.mongo.ObjectId(idRisco); //pega o id do documento
      const result = await riscos.deleteOne({
        _id: id,
      });
      reply.code(200).send({ result }); //se deletar, retorna sucesso
    } catch (err) {
      reply.code(500).send({ error: err.message }); //se der erro, retorna erro 500
    }
  });
}








/*.....=##########*:...                               
                                              ...+++++***********++-..                              
                                            ..:==****++++++++++++**+=-...                           
                                           ...=#*++++++++++++++++++*#*.....                         
                                        ....+#*+++++++++++++++++++++++#*:..                         
                                       ..:*#+++++++++++++++++++########*:..                         
                                     . -**++++++++++++++++++*#*:.......:+*-..                       
                                     . -#*++++++++++++++++++*#*.........+#-..                       
                                    ...-#*++++++++++++++++++*#*...    ..+#-..                       
                                  ...+%*++++++++++++++++++++*#*...   ...+#-..                       
                                 ....+#*++++++++++++++++++++*###*:...:#*:...                        
                                ..:=++*++++++++++++++++++++++**##++++=--...                         
                ............... ..:*#++++++++++++++++++++++++++##++++=...............               
              ....................:*#++++++++++++++++++++++++++#*-....................              
           .... +#############:.-#*++++++++++++++++++++++++++++++*#-.:#############+.....           
           -****+=============***#*++++++++++++++++++++++++++++++*##**=============+****-           
       ..-++++++==============++++++++++++++++++++++++++++++++++++++++==============++++++-..       
       ..=#*=======================++++++++++++++++++++++++++++++=======================+#+..       
       ..=#*=====================++++++++++++++++++++++++++++++++++=====================*#+..       
    ...##+-======================++++++++++++++++++++++++++++++++++======================-+##...    
   ....*#+====================++++++++++++++++++++++++++++++++++++++++====================+##....   
  ..:-=++==========++=========++++++++++++++++++++++++++++++++++++++++=========++==========++==:..  
  ..-#*===========+*+=========++++++++++++++++++++++++++++++++++++++++=========+*+===========*#-..  
  ..-##=======####=.:*#+======++++++++++++++++++++++++++++++++++++++++======+#*:.=####=======*#-..  
  ..-##=======##-..  ..+#*==++++++++++++++++++++++++++++++++++++++++++++==+#+..  ..-##=======*#-..  
  ..-##====+*+::...  ..+#*==++++++++++++++++::::::::::::++++++++++++++++==+#+..  ...::+*+====*#-..  
..:====::-======:..  ..+#*==+++++++++-------............-------++++++++++=*#+..  ..:======-::-===-..
..=#=....:-:.:*#-..  ..+#*+++++++++==. ......          ........==+++++++++*#+..  ..-##:.:-:....=#+..
..=#=........:*#-......+#*++++++++=. ....                  .... .=++++++++*#+......-##:..... ..=#+..
..=#=...   ..:##-...:*#*+++++++++===--=:.....          .....:=--====+++++++++#*:...-##:..    ..=#+..
....-*+....-*+::....:*#*++++++=========-----...      ...-----=========+++++++#*:....:.+*-....+*-....
  ..:==----===..  ..:*#*++++++=======-:::--=::...  ...::==-:::-=======++++++*#*:..  ..===----==:..  
    ...####+...   ..:*#*++++++=======. ...-===:..  ..:===-.....=======++++++*#*:..   ...=####...    
       .....      ..:*#*++++-----=-..+###*:.-=:..  ..:=-..+###*..-=:....=+++*#*:..      .....       
                  ..:*#*++++----:..-=======-...      ...-=======-...  ..=+++*#*:..                  
                  ...:-+**++----:...:::::::....      ....:::::::....  ..=+**+--...                  
                    ...+#*==----: ................................ .....-=+#+...                    
                  .....+#+------:..        .:-:......:-:.          ... ...=#+.....                  
                  ..:*#=------=+-........   ..:------:..   ........-+=    ..:##:..                  
                  ..:*#=------=++++++=+-....................-+=++++++=    ..:#*:..                  
                  ..:*#=------=++++++++=--------------------=++++++++=    ..:#*:..                  
                  ..:++===----===++++++++++++++++++++++++++++++++++==-   .::-++:..                  
                   ....+#+----..:++++++++++++++++++++++++++++++++++:.. ...=#+....                   
                       ..-#*----:.:=+++++=................=+++++=:......+#-..                       
                       ....:*#=-:.:=++++++++:...........++++++++=:...:#*-....                       
                         ..:*#=--:::-=++++++=-----------+++++++::....:#*:..                         
                       ....:**=---:..=++++++++++++++++++++++++=......:**:.......                    
                     .........+#+----..:++++++++++++++++++++-..  ..=#*............                  
               ........+%#####=:-------:....=++++++++++=...........:--#########:.....               
           .... =*************++=----..........................::::=++******+==+***=.....           
       ....:----+*******+*****+==----::::..................::::----=======+*+==***++----:....       
    ...::::=*###*+*+++++++++++=-----:----:................:---------------=++++++=-+##**=::::...    
    ...####**+++++***+*=-----------..:-----------------------------:....:------+****++--+####...    
....-*#******+++**+-----------.....----=++++++=----..:-=++++=-------------:..------=**+++*+--*#-....
..-********++++*==----------..:----+++++*+++==-------:.:-=+++++++=-------------:.:--====+*+++****=..
..=#****++++=====---------::::--===+*++++++=---------:..--==+*+*++==-----------:::::----==+++***#+..
..=#****++++-------------:..----=*+*++++++-----------:..----=+++*+*=-------------:..------=+++**#+..
##*+**+++=-------------...----+*+++++**+----------------..:----+*+++*+-------------:..:------+**+*##
##*+*+********-------. :---=+**++++*+=------+********+--..:----++++++**+=-------------*******--=+*##
##*+**********++=-----:----=++++++**+=-=++++**********++++=----==+*+++++=----------=++*******++==+##
##*+************+=-:------==+++++*+++==+******************==-----+*+++++==-------==+***********=-+##
##*+**************=.:----=+*+++*+++=-+**********************+----+++*+++*+=------+*************+-+**
##*****************#*=-+**+++++*+-=****************************----=++++++**+--*#**************##+..
..=##*********####+.:*#*+*+++++*+-=************######***********+=-=++++++*+*#*:.=####*******##=....
+++**++***###*----:.:*#*+*+++++*+++**********#+------+#**********=-+*+++++*+*#*:.:----*########*+-..
##*++++***#*+=......:*#*+*++++++************++-......-++*********+=+++++++*+*#*:......=+*########+..
##*++++++*#+...   ..:*#*+*++++++**********##:...    ...:*#**********++++++*+*#*:..   ...=########+..
##*++++++*#+...   ..:*#*+*++++++**********##:..      ..:##**********++++++*+*#*:..   ...=########+..
.:=######-.....   ..:*#*+*++++++********#+:...        ...:+#********++++++*+*#*:..   .....-####=....
..:------...      ..:*#*+*++++********#+-:...          ...:-+#********++++*+*#*:..      ...----:... 
...........       ..:+****++++*********=....            ....=*********++++*****:..       .......    
                  .....+#*++++*****##: .                    ..:##*****++++*#+.....                  
                  ..:#######*****#+:..                        ...+####++++++*##:..                  
                  ..:*##########+....                          ....+##++++++*#*:..                  
                  ..:*##########+...                            ...=#*+++++++#*:..                  
                  ..:+*#######**=..                              ..=**+++++++*+:..                  
                   ....+######:..                                  ..:######+....                   
            */

/*

                                                                                                                                                                                                       
@@%%%%%%%%%%%%%%%##*#**==++******++**=--====+#*==---=+++*=--======---======++==-===+++++++++**+++++**+**#**###################%%%#################%###%#**+=+**#%%#+=+=+:=+=====++==--====---=-==+#%#%@
@@%%%%%%%%%%%%%%#*###++++++==+*****+---===+**=+===++*+===-==-==========++*#%#+==++++=+++++++++++++++*****#%%*#%@@@@@######%##%%%%%%%#######*###########**####*###%%#*+=**+-=*+--===+*+==+*#*=*+====-+%@
@%%%%%%%%%%%%%%#*###****+==+******+++===+*#%#+===+==--+##+=-++===----==++-=+====---==++++++++++++++*++**#*****####****%@@@@@%@#%@@@%#****%@@@@@@@@@@@@@@%%#*####%####++**++===-=++=+++-----+++=-=*##*%@
@@%%%%%%%%%%%%%####*****++********+++==###%%#-=++=-===*@@%++#+===-----==-+%%%*=-=++++*%%%%#+====++++%@@@@@@@%**##**+%@@@@@@@@@@@@@@@@++%@@@@@@@@@@@@@@@@@@@%#+++**#%##*#*+===**+=-:====-=++###*#%%%%%%@
@@%%%%%%%%%%%%%%####************+++*#+##%#+=-=**===#*++====*+===-::=#@@#*@@@@*+=*@@@@@@@@@@@%+=====@@@@@@@@@@@@@@+#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#=======*##+=+###*+-:=+***+*#**##%%%%%%%%@
@@%%%%%%%%@%%%%%%%#*****##**++++++=++=+=--+*=-=*==**++++=*@@@*====*@@@@@@@@@@#*%@@@@@@@@@@@@@@@@%*=%@@@@@@@@@@@@@*%@@@@@@@@@@@@@@@@@@@@@%#*@@@%#*++=++=+++##%#+=****+#%#*####*=+****##*+*##%%#%%%%%%%%@
@@%%%%%%%%@%%%%%%%#****###**+***+==++=---=%#+=--=+=+%++=+@@@@@%++%@@@@@@@@@@@#%@@@@%@@@@@@@@@@@@@*-@@@@@@@@@@@@@@%@@@@@@@@@@@@@@@@@@@%##%%#*#+*=====-=+#%@%%%%#+-*##%%########--++=**#*+*#%%%%%%%%%%%%@
@@%%%%%%@@@@%%%@@%#######****+======+==#=---+#%*+%%%%+=+@@@@@@@@@@@%@@@@@@@@@@@@@@%@%%%%%@@@@@@@@#+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%***++*#####**#==##%@@%@%%#*==+#%%%%%=-*+*++=**+**#+*##%%%%%%%%%%%@
@@%%%%%@@@@@%%@@%%####%%%*++====+=*#+-==++=%@@%*#%%%%*%@@@@@@@@@@@%%@@@@@@@@@@@@@@%%%%%%%@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%#+*++##%%%######**#%@@%%@%***-:-#%%%%%#-:-+=*+**++##++##%%%%%%%%%%%@
@@%%%%@@@@@%%%@%%%##%%%#*****++#+*%#=-:#@##@%%%%%%%%+#@@@@@@@@@@@@##%@@@@@@@@@@@@%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%####+*#####%%####+###*#%@@%#%@#***-=*%%%%%%*===++*===+##*+###%%%%%%%%%%@
@@%%%%@@@@%%%@@%%##%%%%#*****++++#%+=-*@%*@%%%%%%%@@%@@@@@@@@@@@%%##%@@@@@@@@@@@@@%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@%@#*@#%@%#*#**#+*###%%####*###*#%@@%*%%%##*=+*%%%%%##*-:=+=:=++*##+*##%%##%%%%%%@
@@%%%%@@@%%%%%@%%#%%%%%#***##*++++++==%@##@%%@@@@@@@@@@@@@@@@@@@#*+#%%@@@@@@@@@@%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@%%%%*%@##%##*#%%###%%%%%%###**+*##@@@%+*%%%%#*=+%@%%%#**=-:=*+:=+***+*##%%##%%%%%%@
@%%%%@@@%%%%%%@@%%%%%##******+*#*+=+#*@@#@@%@@@@@@@@@@@@@@@@@@@@#+*##%%@@@@@@@@%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%#*%#*#*%%%#####%%%*#%#+###*#@@@#+*%%%%%#=+@@%%%##+-:.-**--+###+*##%%%#%%%%%%@
@@%%%@@@%%%%%%@@%%%%###*#*****%@@*=%%%@@@@@@@@@@@@@@@@@@@@@@@@@%*+*#%%@%%%@@@%%%%%%%####%%%@@@@@@@@@@@@@@@@@@###%@%%%%%%###+*#+*%*###%%##%%#*##*###+*%@@@#*%@@#+##++%%%%%#*#=-+=-=--*###=*#%%%##%%%%%%@
@%%%@@@@%%%%%@@@@%%######***+*#@@%=@@@@@@@@@@@@@@@@@@@@@@@@@@%%+=++*%%@%%%@%%%%%#%%#####%%@@@@@@@@@@@@@@@@@@%#%#@%%%#+####+*%#**#%%%#%%%########*##*#@@@@*+%@#*%@%++%%%@#*##=-+++*--+###++##%%#%%%%%%%@
@%%%@@@@%%%%%@@%%%%#####@%##**%@@%*@@%%@@@@@@@@@@@@@@@@@@@@@%*--+==+##%%@@%%%%####***####@@@@@@@@@@@@@@@@@@%+#*##%#==***##+*+#+=++#%%-++--+#*###*#*###@@@#+%@+%@@%=+%%%%#*##+-++*#*-=#%#++##%%%%%#%%%%@
@%%%@@@@@@%%%@@%%%%###*%@##%#*@@@%%%%@@@@@@@@@@@@@@@@@@@@%#+::-=+++=+*##%%%%##%%%#***###%@@@@@@@@@@@@@@@@@@**#*#%%*=##*+**+*+**+#%#%+=++++++--+****%%#@@%#=#%+%@@%#+%%%%++#+=:+=###=:*%%++###%####%%%%@
@%%%@@@@@%%%%@%%@%##*#%#**##**@@%%%@@@@@@@@@@@@@@@@@@@@@@#==+**+***+++**############*##%@@@@@@@@@@@@@@@@@%%%+###%*+#%####*+#%%%%%%@*-===+=+=+++=---=*%@@@#=*%*%@@%+-%%%#*%%#-:++*##*-*%%++###%%##%%%%%@
@%%%@@@%%%#%%@%@@%##*#***#*%#*@@@@@@@@@@@@@@@@@@@@@@#++#%#++**+=*#***++++*########*+*##%@@@@@@@@@@@@@@@@%%%%%%##%*##***+*+#%%%%%@@%==+====++++++=---==-:-*=+%+#@@@*-%%%*@@%*-:*#*+***=%%#+*#*%%#%%%%%%@
@%%%@@@%%%#%%@@@%%*##***@@@@#*@@@@@@@@@@@@@@@@@@@@#=:=++#%##*#%@@@%%#*++++**####****#**@@@@@@@@@@@@@@@@%%%%%%%#*+%%%%##**+#%%%%%%@#=+++**++++++====+++****+==+*%@@*=%%*%@@@*--*###***#%%*=*##%%%%%%%%%@
@%%%@@@@%%%%@@@@%##%##*%@@@@#*@@@@@@@@@@@@@@@@@@%=-..=*##%#*%@@@@@@@%#***++*#####**##*#@@@@@@@@@@@@@@@@%%%%%%%*=*####%%%**%%%%%%%%*=++++****+++--++==-==++**++======%*+@@@@=:=**##****#%*=*##%%%%%%%%%@
@%%%@@@%%#%%%@@@%##%%##@@@@@#*@@@@@@@@@@@@@@@@#+==-==###+#@@@@@@@@@@@@%##*****#*##****%@@@@@@@@@@@@@@@@%%%%%%*#*%%%%%%%%%%%%%%%%%%==++**+==+=-=----:--=++++*+=++-::::-+%@@%-:*#*#####*#%%#+##%%%%%%%%%@
@%%%@@@%%##%%@@%######@@@@@@@@@@@@@@@@@@@@@@#=:=++**#**%@@@@@@@@@@@@@@@%####**####***+#@@@@@@@@@@@@@@@@%%%%%#*%+%%%%%%%%%%%%%%%%%*-+===***+===--:::----=+++**==--:::*+=+%@#::#**#%%##*#%%*###%%%%%%%%%@
@%%%@@@@%%#%@@@%%%%#*@@@@@@@@@@@@@@@@@@@@%#-:-=***##+*@@@@@@@@@@@@@@@@@@%%##*#***####+#@@@@@@@@@@@@@@@%%%%%%+%%%%%%%%%%%%%%%%##%#:====--=-::::::::+*-+-=++++----...-#--*#%#-=###%+***##%#::##%%%%%%%%%@
@%%%@@@@@%%%%@@%#%#**@@@@@@@@@@@@@@@@@@#*+---=+**##+#@@@@@@@@@@@@@@@@@@@@%%###+***#*#+#@@@@@@@@@@%%%@@%%%%%%=%%%%%%%%%###%%%%###=-===---:.::...:=..::++-+*==-=++=-==:==##+=-+%#-+=-#+-%%#=+##**#%%%%%%@
@%%%@@@@%##%%@%#####%@@@@@@@@@@@@@%#+=-=-:::=++****%@@@@@@@@@@@@@@@@@@@@@@%###**#*++*+*@@@@@@@@@@%%#**#%%%%#+%%%%#%%%%%%%%%####+=*++++-:....-:.........===++=--+=::..-+%#*++=+###%###*#%%==###%%%%%%%@@
@%%%@@@%%%%%%@%#####@@@@@@@@@@%%###+-=+:..:-==**#*#@@@@@@@@@@@@@@@@@@@@@@@@%####%#+++=+@@@@@@@@@@%%+#*%%%#%+%%%%%#%%%%##%%#*+*#++***+=--::=.+#:. .....:-=---=+++-:+%=-*#+++++=-=###**%%%%=+#-=%%%%#%%@@
@%%%@@@%%%%%%@%#####@@@@@@@@@%%##*+-==:..:-+++**+*@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%#*+*=+@@@@@@@@@@%=#%*%#*%##%%%%%#%%%%%%%%%%#**=*##*++=+**==%%@%: ......:+-==++=+::+=+#*+=---==---+*###%*=+*+=*#%%%%%@@
@@%%%@@@%%##%@%##%##@@@@@@@@@%#**=:-=---:-==++**+%@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%#**+-#@@@@@@@@@@%=##*%###*#%%%%%%%%%%%%%##*#%+=++**+++*%*=-----:.=..++**==-=++=::-==**+++=---.:::+=+**%#=+#*=+%%%%%%@@
@%%%%%%@%%#%%%%##@%#@@@@@@@@@#***===-:::-==+****=@@@@@@@@@@@@@@@@@@@@@@@@@@@%@%%%##+=+@@@@@@@@@@@%=#+@%###*###%%%%%#%%%%%#**##-===+=+#*+%%*++-.:+%%::=#@%-=====-::::=*=----:.:..-*-=*+-#%*=-*#%%%%%%%@@
@@%%%%%%%%%%%%%*%@%#@@@@@@%%%#**=-=--:::-=*++***=%@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%###++@@@@@@@@@@@@%**@@%*##*##*######%#####%%#-===+=-:++=+==.=-..-=#-:.-:-:+*-+====++**+==:... -+-:-=#+#%#===*%%%%%%%%@@
@%%%%%%@%%%%%%%#@@@%@@@@@@%%%#**=+=--::-==++*****%@@@%%%@%%%%%%%@@%%%@@@@@%%@@%##%%@@@@@@@@@@@@@@@@@@+%*##*#*#######*##******:+=+=:....==++#+-.-::::-*+-:-+*--==+==*#*+=-.... ...=*##*=##++*#%%%%%%%%%@
@%%%%%%@@%######@@@@@@@%%%%%%#**+++--::-=++*####*+*#%%#+*%%#%##%%%%%%%%%%%%@%%#*@@@@@@@@@@@@@@@@@@@@#+*+++=++#**+***#*##****=+*##*-=....:+*%=-=-::-++==+#%#+--==+****+++=+=-..+#==##**==%#+*##%%%%%%%%@
@@%%%%%@@%###%*%@@@@@@@@%%%%%%##+++==--=++**##**+++*#*+=-#%##############*%%####@@@@@@@@@@@@@@@@@@@@*+++++++=+***+++=**++**+==+#%%#===:..--+#**+#+++*%++*+++--=*****=-:..-==-:=++#*+++++*#+#%%%%%%%%%%@
@@%%%%%@@%%##%*@@@@@@@@@@@%%%%##***=++=++**###*+++++*+==-*#######******#*%%#****@@@@@@@@@@@@@@@@@@@@+=+++*++===+===+++++=+*+-==+*%%++*++=-:.-=*##++##**+=++*=-=++**+=-:....:=+=-+++=-:-==++#%%%%%%%%%%@
@@%@%%%@@%%%*%*@@@@@@@@@@@@@%%#####*+++**########*+**++-=%##**##*+++++++#*+++++*@@@@@@@@@@@@@@@@@@@@+-+*++++++==-=-=+***++*==--=++#%#=**-:....++*+=+***=#%++-++++**+==:.....-+*#*#+:*%#:.===#%%%##%%%%@
@@@@@%%@%%%#*%*@@@@@@@@@@@@@@@%######***##*#***+=+++-=+*%#+*****+=-====**=-==+++%@@@@@@@@@@@@@@@@@@@=++==+++++**+*+******++=*%+-=++*%%***+=.....=*--==-=##=::==++**=-=+-.:-:-+*=-+++#*=...-=-+%%%%%%%%@
@@@@@%%%%%%#*%*@@@@@@@@@@@@@@@@%######*+++**############*+++****=------++::-==++*#%@@@@@@@@@@@@@@@@%=++=++++++=+*+=++-===+-:+#*=--=+*#%*+*=--:.:..-----===:-+++***++--::::==**+-.::-*+..:.====*%%%%%%@@
@@%@@@%%%%%%*#*@@@@@@@@@@@@@@@@@@@%%%#=..-*##**+==*****+++++***+++=:--=**====+==+%@@@@@@@@@@@%#%@@@%=+*++*+*=+*+===+=-=#*-++:-=:-=++*##*+*+=+++---==----=++++*****+*+-:.:--+*+=+=..:##:.=+***+%@@@@@%@@
@@%@@@@%%%@%%#@@@@@@@@%%@@@@@@@@@@%####-..:-+++*++++*****+=-=++--++====###*##*-::=%@@@@@@@%%%*=-=+*#+++**+++++++-:::=%@@@+=++**++++++++=+=-:..:-=-.=+++++==--==-=++++--:--+*%%%+=-=-...:=+*+*%@@@@@%%%@
@@%%@@@@%%%@%*@@@@@@@@%%@@@@@@@@%@#+===:.:=...:==:-+++#**+-.:==:..=++*@@%*=:.=#@@=#@@@@@@%+==:...::-=+=+*++-.:-:....:#@@=.:=-:+*+=-::--:::.......-.-+*+---.......-+++===-=#####+==---+#*-=*##*#@@@@%%%@
@@%%%@@@%%%%@*#@@@@@@%%@@@@@@@@@%#+==:=%@@@...+@@@*=:-+*+=-.+@@@*..-%@@%+-=@@@@@@*@@@@@@%+:..-#@@@=:-:=+*#+:.-=+*#%@@@@@@@@@%-+++-.+@@+..+%@@@@@=-:-++--::+%@@@@%+:-+++***++%%=-::=-----**++#*+%@@@@@@@
@@%%%@@@%%%%%%*@@@@@%%%@@@@@@@@@@#==%@@@@@@@#*%@@@=..:**=+#*%@@@@@+-+#@%*##@@@@@@*%@@@@@@+-*##@@@@@%:.:*##*+****%@@%##*+==-...=--#@@@@@%#*#@@@@@*===--=*%*###%@@@@@%+++**=:-++==-====+*%#*+==+++%@@@@@@
@@%%%%@@%%#%%%*%%%@%%%@@@@@@@%%%@@%**+=@@@@:..=@@@@%+.:+#+++==@@@@@*:+#@@@%*%@@@@=#@@@@@@%*-+*=*@@@@%..+#%%##+-*@@+=*#+--......:+#@@@@*.....#@@-=++-=%@#++++++*#@@@@@==*+=-::::-===+***%%%#+:-+++%@@@@@
@@%%%%%@%%###**%%%%%%%@@@@@%%%%%@@%%%%#@@@@#%@@@@@@@@@=-***+==@@@@@@+.-*%@@*%@@@@-+%@@@@@#+=-::+@@@@@@:=**###=%@@#.-**=-:=#%%*.-*+#@@@+....*@@:..--*@@@-+***+=++*@@@@#=++=-::::=+**+=+#*#%#-..-:+*%@@@@
@@%%%##%%%###*+#%%%%#%@@@@@@%%%@#++#%%+%@@@=-:::=%@@@@#++=-+%%##@@@@@=:=#@%=*@@@@*%**%%@%+-.-%%##@@@@@%-:=**=#@@@*:-*=#%#*#@@@%**=*@@@#-+%@@@@@@+.-@@@%-+***=::-:#@@@#=+++==-==+*#+--:::=+:..:-==+#@@@@
@@%%%%#%%%%###*+#%%%%%@@@@@@@@@#+*#*=+-%@@@----=++#@@@=.:%@%:-=:*@@@@@+-#@%=+@@@@-----=++-*@%:...-@@@@@#..=+=@@@@%::-+*##*=*@@@+==*@@@%+**=#@@@@@*+@@@@+=+*+-....*@@@#+++++++*###*::.:..--:--.=**+*@@@@
@@%%%%%%%%%%#%#%*+%%%%@@@@@@@@@###*++*+@@@%....:--*@@=-+@@@%::---@@@@@@--*%*#@@@@..:.....#@@@-....+@@@@@*..=+%@@@@%...-=+++#@@+=--#@@@*=#%%#*@@@@%=@@@@%=-:.....-@@@=+=**+**###*+-:....-*%*-*#+=*%@@@@@
@@@@%%%%%%%#####%#+#%@@@@@@@@%%*%%##%*+@@@@#=:::=##==+*#@@@@@%##++*@@@@@*=+#@@@@@*++++++=%@@@@@##*++%@@@@%++%%@@@@@@%+---+%@#==**=#@@@+*%%%%##@@@@.#@@@@@%*-::=#@*==+==+****+*==+=:.:-===++*##%#@@@@@@@
@@@@@@@%%%%####*#%#*=#@@@@@@@%*+***%%++%@@@@@@@%+=++-+**+%@@#++*#*=*@@@%*+%*#@@@@@@@@@@#--*@@%*++*#*=#@@@%*#%%*+#@@@@@@@#*+*%+*#%**@@*+**#%%#*@@%*+=+%@@@@@@@%#++**=++***++++++=+++++++*#%%%####@@@@@@@
@@@@@@@%%%%%##%####*#+*@@@@@@%##+-+*%#*#+==+=-:==#***#%*++*#*####+-#*##%@@@@%##******+#%@@%#*%#*#%#+**++***###*##**+****#%@@*:##*+====##***#%#**##=##*+=---=+++*##*****#*++++***+*#####*#*##***%@@@@@@@
@@@@@@@@@@%%%%%###**+*+==#%#**#%==+#=:-#%#%%-.:=-#-:+*####%%#*###=+@@@@@@@@@@@%%%@@%@@@@@@@@%%#*##+#####%%%%%%%++%%##%%%@%%%#:*#**=-+.+#*++*#%%##%#=**=:....+***#****++#*****##*****++=-=++****%@@@@@@@
@@@@@@@@@@@%#%%%##**++++++=#*++#%##*:-+:.-=%*=++#:.-#*%**##%####+=%@@@@@@@@@@%%%%%%%%@@@@@@%#%%**%=*#*+**##*%%##%##+*#%%%%%%%%=*#**---:+##*++#%%##%%+**=:...+####*##+++***##%%#++++=+==:-=**+**#%%%@@@@
@@@@@@@@@@@@%#%%##%#*++++++*#****=+#*+-.:=##*#%%*==****=***%##+*=:@@@@@@@@@@@%%%%%@%%@@@@@@%#+%*#**#++#*#%%*#%%##%%%%##%%%%%%%%*+*#+=:..=##*=*#%%#%%#+**=...:***###***##**+++**+=====-:=:-+++*#%%%%%%@@
@@%@@%%%%%@%%%%%%%###*+**+=+*=+#**#=+*==**#..=+#%##+=#+*#+#+*#-*+:@@@@@@@@@@%%%%%%%%%@@@@@%#*+#*#=##*******###%#*%%%%%%#*#%%%%%###+**+-..:*#*+=*#%####=+*-...+######*+**+**++*+=-:::+-*+==+++*%%%%%##%@
@%%%@@%%%%%@%%%#%%%%#*++++=++++==*+=*##***=:=+*#+##%%%##**#*#*=#-*@@@@@@@@@%@%%%%%%%@@@%@%%#*-=*#=*###*=*##+##*###%%%%%%%%%##%%%%%%#=#*=...*%#+=+*%####+#+-..:###%#+==+****++=-:=-.-=::+*++**#%%#%#*#%@
@%%%%%@@%%@@@%##%%%%%###*+=-===++==++*#+=****%*+**+%%%##%%##*+#++@@@@@@@@@@@%%%%@@@@@@%####**=%#+***+*##++**#*+*#######%%#%#%###%%%%%#*#*=:.:*#*+=*####+**-::.-*+*==+***#*====--+-==:==+*****#####%%#%@
@%##%%%%%@@@@%%%%%%%#####%#++==-=++++*+=+#%####**#%%*##*+##+##*+%@@@@@@@@@@@%%%@@@@@%@#*+##**+%#*#**##**####+*+###*##*#####*###*+*##%*#++#*=.:+##*=+*##*+*=::::-+*+*+=+****=++===**==+=+***#*#####%%%%@
@%#%%%%%%%@@@@%%%%%%##%%%#%@%*++====**+**##++%%%%%%%#%**##+:*-#@@@@@@@@@@@@@%%@@@@%%%#=+*#*+*%%%##%##*#*=*+*##+**####*####*-+#+*#*+**=**#=*#=::-+#+==+#*+#*-=:...+++++*##++===+====+**++**###%#%%%%##%@
@%%%%%%%%%@@@@@%%%%%%%%%%#%%%%#+=-===*=*##*##%%%#*#%%###*+=++%@@@@@@@@@@@@@@@@@@@@%#*+*+#*+*+%%%#%#%%%#**##**##**#*****+****************#+=*#+:.:=*++++**##+-+:..:+*++*##*===+*+**+***+***########%###@
@%%%%%%%%%%@@@@@@%%%%%%%%##%%%#+*---====+*###%%#*%%%%##***#@@@@@@@@@@@@@@@@@@@@@@@%+*%%%%**#%%%%%###%%%*++#####*#*#****##*++*#*+=+++***+***+=**+--::-**#*%#*+-:::.:+***##*=+*#*+**+*###**###++*#%%%##%@
@@%##***####%%%@@@%%%%%%###%@%%%#*+======**#%%##%%%%%*=#@@@@@@@@@@@@@@@@@@@@@@%#%##=%%@%%+#%%%%%%%%%@@%%%%%*+****#++#*+###+=***++#*##+**=+*++=*#+:.-::+#*###+=--::=+#*####*##%###**########*+==-::+*#%@
@@%###%%%%###%%%%%%%%%%%%###%%%%#***+======*%%#######@@@@@@@@@@@@@@@@@@@@@@@@%*###**%%%%%*%%%%%%%%%%%%%%%%%%##%##*#%%#**++*+**+=****#+***+*##*=##*=--:-*#*%#**+++++==+######%%##*####%%%#####%#%###%%%@
@@%@@@@@@@@@@@@@@@@@@@@@@@%%###*###****=--==*%%####@@@@@@@@@@@@@@@@@@@@@@@@@@*#%#*+####%#*#%%%%#%%%##%%%#%#+#*+#****#*#%*==**+++*#%#****+**+*#*-*#*+++=*%#%%##*##-....:*#%#%%%###*###%######%##*#%##%%@
@%##%%%%%%%%@@@@@@@@@@@@@@@@@%%%##****=++-===#%####@@@@@@@@@@@@@@@@@@@@@@@@*#*%#++*%####%#%%%%%@%%%%#%##%#%%##%%##%%%#*##*#**-+*****##+=++++**#*==***+-==++--#*+=.....:-*#####%%%%%%%%#####%%%%%%%%%%%@
@%%%%%%%###***####%@@@@@@@@@@@@@%%####*=++++==###*#@@@@@@@@@@@@@@@@@@@@@@@%*%%#+%+##%%%%##%####**%%%%##%###%%%##%#**###**#***#*****++******#*##*###*=-++*#+==*#*==::-::==##%%%%%%%%%%%%%%%%%#%%%%%%%%%@
@@@%%@%%%%%##%%%%%%%%%%@%@@@@@@@@@@%%##*+=+++**##*+@@@@@@@@@@@@@@@@@@@@@@@%*%%*#%#*%#####%%##%%%#%#+#%##%%########%%%%#######%######*****##***+*#%*++=#++#===#*#***+==+++#*+##%%#%%%%%###%###%%%#####%@
@@@@@@@%%%%###**********++***##%%%%%%%%%#**+==***++@@@@@@@@@@@@@@@@@@@@@@@##%#+*##%%%##%%%%%%#%%#%#**++#%#########%####%%%%%###%%%##*##%###++*##%@*++=:-+*++**##%##****+**#####%#%##%%###%#%#######%#%@
@@@@@%%%#**********#######%%%%%%%###%%%%%%#*+=***=*@@@@@@@@@@@@@@@@@@@@@*@*%%##%%%%%%%%%%#%#####**+#######*#########*#%%##%#**%##%%%######%@#**#@@%-++***#*#####=-=--=+****#########%%%%#%%%###**##%%%@
@@@@@%#**#############%%%%%%%%%%%%%%%%%%%%%#**+*+=@@@@@@@@@@@@@@@@@@@@@#+#*%%+#%%%%%%%%%%%%##%%#+*####*#############*=++*#%%%%%###%####**#*####@@@@#+=*###%%%%#====-:-=+#**#########%%#*##%###****###%@
@@@%%#######%%#%%#%%%%%%%%%%%###********#%%%%%##**#%@@@@@@@@@@@@@@@@@@%*%=%@%*@@%@@@@@%%%#%%%#%#%###%%%#%%#####%###***#########%%%%#*#####*=##%@@@@@@@*===*#%%==++-..:==**++***####*#%#####**#*+#####%@
@@@@@%%@@@@%%%%%%%%%%%%#####****+++++**###***###%%#+=#@@@@@@@@@@@@@@@@**%#%@@@%%%@@@@@@@@@%%%%%%%%%%%%%#%#####%%%%%%%###**#####%%%%##%###*#*#%@@@@@@@%:-=+**%*-+==-..:=+*%*++*****#########****####**#@
@@@@@@@@@@@%%%%%%%%#**********#*##*###%%%%##%%%%%%%%%%#*+#%%%@@@@@@@@#*#@@@@@@@@@@@@@@@@@#%@@%%%%%%%%%%%%%%%%%%%%##%%%#*+*#%%%%%%###%%%%%###%@@@@@@%%#.-=**#%=++=-...-++#%%###*##***#*#########**#*##%@
@@@@@@@%%%%%%%%##****##############%%%%%%%%###********###%%%#*#%%@@%#*##@@@@@%%%@@@@@@@@@@@@@@@@%##%%%%%#%#%%%#%%%%%%%%##%###*%%%%%%%%%%%%@@@@@@@@@@%+:==+*#%-++=:...+*+##%%%%#*+*#####%%%%%%####*####@
@@@@@@@@%%##********##########%%%%%%%%#*+++++===+**#*++*###%%@@@#+=#%@@%@@@@@@%@@@@%%@@@@@@@@@@@@@@@@@@@@%%%%%%%%@@@@@@%%%%%%#####%%%%@@@@@@@@@@@@@@@=-=+*##=++=-.:-=**#*+***+**##*+###*#%%%%%%%#####%@
@@@@@@@%%#################%%%%%%%%#**++++++++++***#**##%%%@@@@@@@@%+#%@@@@@@@%%%@@@%%@@@@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%##%%%#%@%@@@@@@@@@@@@@@@@---=+##++=-...:**#######***+*++#%%%#*++=+*#***#%%@
@@@@@@@@@@%%%%%%%%%%####%%%%%##*+++++==+*********##%%%%@@@@@@@@@@%%%*****##**##%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@--++*#++*=:..-=#**+#%%%##***#+++**%%%%#*****####%@
@@@@@@@@@@@@@%%%%%%%%#%%%#**+++++==++++***########%%%%%%@%%%######***##%%%%%%%#*++*#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%:=+*##=+=:..-=*+##*++*%%##%%%%##****##%@%%##%###%@
@@@@@@@@@@@@@@@@%%%%##*++++++**++******####%%%%%%%%%%%##*********#**####%%%###%%%%#+-#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#-++*#+++-:..-=+%@%%#**#%%%%##%%%####****#%@@%%%%@@
@@@@@@@@@%%%%###****+***+++++********######%%%%%%###*+++==++++++**###%%@@@@@%%%%%%@@%***###%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%+-==++==+=---+*#@@@%%#*#%%%+*#*+**#*########%#%@@@@
@@%@%%%%%%#####******++++++****###*######%%%##*+++++=====++++++**##%%%%@@@%%###%%%%%%####**+==#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#+==++++=====+++++%@@@@@%%%%%%##%%%%%%%#++#*-+%%%%@@@@
@@@%%%%%%############****########***######***++*+++++++**+***####%%%%%%#*++*#%@@%%%%%%%%#%%%%%#*#%@@@@%@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*==++++***+++++=+=+#@@@@@@@@%%%%%%%%##%%%%#**%@@@@@@@@@@
@@@@@@%%%###############%%%###########*++===+++====++++++***####%%%#*+==+*#%%%%@@@@@@@@@@@@%%#%%*+*%@@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%++=*####*****+===+++==%@@@@@@%%%@@@@@@@@@%%%%%%@@@@@@@@@@@
@@@@@@@@@%%%%%%%%######%%%%#######*+++==========++++****+*#######*+==++*#%%%%@@@@@@@@@%%%%%%%#*++++*%%%%%%%@@%@%@@@@@@@@@@@@@@@@@@@@%%@@@@%+=*#%%#%%%%%%%%%%*==+##**@@@@@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@%@%%%%%%%%%%%####*+====++=======++++*******######*+=+++**#%%%%%%%%%%%%%%%%%%%%%%%%%%#===*%%%#%###%@%%%@@@@@@@@@@@@@@@@%@@@%#*##%%@@@@@@@@@%@@@@@%##%@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
*/
