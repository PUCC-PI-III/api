
import fastifyMultipart from '@fastify/multipart';

export default async function (fastify) {
    fastify.register(fastifyMultipart); 
    //cria a rota tipo POST de riscos, responsável pelo cadastro de riscos
    fastify.post('/riscos', async (req, reply) => {
        const db = fastify.mongo.client.db('projetoI'); //determina o database
        const riscos = db.collection('riscos'); //determina a collection

        try {
            const data = await req.file(); //determina que 'data' equivale ao valor recebido na chamada de req.file, método da lib 'multer' para receber arquivos
            const tit = data.fields.titulo.value; //titulo(propriedade de 'riscos')
            const obs = data.fields.obs.value; //observações(propriedade de 'riscos')
            const localizacao = data.fields.localizacao.value; //localização(propriedade de 'riscos')

            const buffoon = await data.toBuffer(); //converte os dados para tipo binário através do método 'toBuffer' e armazena na constante 'buffoon'(balatro mencionado)
 
            const b64 = buffoon.toString('base64'); //converte a constante em buffoon para base64

            const newRisk = await riscos.insertOne({tit,obs,localizacao,imagem: b64,
            }); //armazena o resultado da operacao de inserção no banco numa constante 'newRisk'

            reply.code(201).send(newRisk); //retorna sucesso e envia o resultado da operacao
        } catch (err) {
            reply.code(500).send({ error: err.message }); //retorna erro
        }
    });

    fastify.get('/riscos/:id', async (req, reply) => {
        const db = fastify.mongo.client.db('projetoI');
        const riscos = db.collection('riscos');

        try {
            const { id } = req.params;
            const risk = await riscos.findOne({ _id: new fastify.mongo.ObjectId(id) });

            if (!risk) {
                reply.code(404).send({ error: 'Risco não encontrado.' });
                return;
            }

            const buffoon = Buffer.from(risk.imagem, 'base64');

            reply.header('Content-Type', 'application/json').send({
                titulo: risk.tit,
                obs: risk.obs,
                localizacao: risk.localizacao,
                imagem: buffoon.toString('base64') // Send the image as a base64 string
            });
        } catch (err) {
            reply.code(500).send({ error: err.message });
        }
    });

    fastify.get('/riscos', async function (req, reply) {
      const db = this.mongo.client.db('projetoI'); 
      const riscos = db.collection('riscos');
      try {
        const allRiscos = riscos.find({}).toArray();
        return allRiscos;
      } catch (err) {
        return { error: err.message };
      }
    })
}



























           
                                                  /*.....=##########*:...                               
                                              ...+++++***********++-..                              
                                            ..:==****++++++++++++**+=-...                           
                                           ...=#*++++++++++++++++++*#*.....                         
                                        ....+#*+++++++++++++++++++++++#*:..                         
                                       ..:*#+++++++++++++++++++########*:..                         
                                     . -**++++++++++++++++++*#*:.......:+*-..                       
                                     . -#*++++++++++++++++++*#*.........+#-..                       
                                    ...-#*++++++++++++++++++*#*...    ..+#-..                       
                                  ...+%*++++++++++++++++++++*#*...   ...+#-..                       
                                 ....+#*++++++++++++++++++++*###*:...:#*:...                        
                                ..:=++*++++++++++++++++++++++**##++++=--...                         
                ............... ..:*#++++++++++++++++++++++++++##++++=...............               
              ....................:*#++++++++++++++++++++++++++#*-....................              
           .... +#############:.-#*++++++++++++++++++++++++++++++*#-.:#############+.....           
           -****+=============***#*++++++++++++++++++++++++++++++*##**=============+****-           
       ..-++++++==============++++++++++++++++++++++++++++++++++++++++==============++++++-..       
       ..=#*=======================++++++++++++++++++++++++++++++=======================+#+..       
       ..=#*=====================++++++++++++++++++++++++++++++++++=====================*#+..       
    ...##+-======================++++++++++++++++++++++++++++++++++======================-+##...    
   ....*#+====================++++++++++++++++++++++++++++++++++++++++====================+##....   
  ..:-=++==========++=========++++++++++++++++++++++++++++++++++++++++=========++==========++==:..  
  ..-#*===========+*+=========++++++++++++++++++++++++++++++++++++++++=========+*+===========*#-..  
  ..-##=======####=.:*#+======++++++++++++++++++++++++++++++++++++++++======+#*:.=####=======*#-..  
  ..-##=======##-..  ..+#*==++++++++++++++++++++++++++++++++++++++++++++==+#+..  ..-##=======*#-..  
  ..-##====+*+::...  ..+#*==++++++++++++++++::::::::::::++++++++++++++++==+#+..  ...::+*+====*#-..  
..:====::-======:..  ..+#*==+++++++++-------............-------++++++++++=*#+..  ..:======-::-===-..
..=#=....:-:.:*#-..  ..+#*+++++++++==. ......          ........==+++++++++*#+..  ..-##:.:-:....=#+..
..=#=........:*#-......+#*++++++++=. ....                  .... .=++++++++*#+......-##:..... ..=#+..
..=#=...   ..:##-...:*#*+++++++++===--=:.....          .....:=--====+++++++++#*:...-##:..    ..=#+..
....-*+....-*+::....:*#*++++++=========-----...      ...-----=========+++++++#*:....:.+*-....+*-....
  ..:==----===..  ..:*#*++++++=======-:::--=::...  ...::==-:::-=======++++++*#*:..  ..===----==:..  
    ...####+...   ..:*#*++++++=======. ...-===:..  ..:===-.....=======++++++*#*:..   ...=####...    
       .....      ..:*#*++++-----=-..+###*:.-=:..  ..:=-..+###*..-=:....=+++*#*:..      .....       
                  ..:*#*++++----:..-=======-...      ...-=======-...  ..=+++*#*:..                  
                  ...:-+**++----:...:::::::....      ....:::::::....  ..=+**+--...                  
                    ...+#*==----: ................................ .....-=+#+...                    
                  .....+#+------:..        .:-:......:-:.          ... ...=#+.....                  
                  ..:*#=------=+-........   ..:------:..   ........-+=    ..:##:..                  
                  ..:*#=------=++++++=+-....................-+=++++++=    ..:#*:..                  
                  ..:*#=------=++++++++=--------------------=++++++++=    ..:#*:..                  
                  ..:++===----===++++++++++++++++++++++++++++++++++==-   .::-++:..                  
                   ....+#+----..:++++++++++++++++++++++++++++++++++:.. ...=#+....                   
                       ..-#*----:.:=+++++=................=+++++=:......+#-..                       
                       ....:*#=-:.:=++++++++:...........++++++++=:...:#*-....                       
                         ..:*#=--:::-=++++++=-----------+++++++::....:#*:..                         
                       ....:**=---:..=++++++++++++++++++++++++=......:**:.......                    
                     .........+#+----..:++++++++++++++++++++-..  ..=#*............                  
               ........+%#####=:-------:....=++++++++++=...........:--#########:.....               
           .... =*************++=----..........................::::=++******+==+***=.....           
       ....:----+*******+*****+==----::::..................::::----=======+*+==***++----:....       
    ...::::=*###*+*+++++++++++=-----:----:................:---------------=++++++=-+##**=::::...    
    ...####**+++++***+*=-----------..:-----------------------------:....:------+****++--+####...    
....-*#******+++**+-----------.....----=++++++=----..:-=++++=-------------:..------=**+++*+--*#-....
..-********++++*==----------..:----+++++*+++==-------:.:-=+++++++=-------------:.:--====+*+++****=..
..=#****++++=====---------::::--===+*++++++=---------:..--==+*+*++==-----------:::::----==+++***#+..
..=#****++++-------------:..----=*+*++++++-----------:..----=+++*+*=-------------:..------=+++**#+..
##*+**+++=-------------...----+*+++++**+----------------..:----+*+++*+-------------:..:------+**+*##
##*+*+********-------. :---=+**++++*+=------+********+--..:----++++++**+=-------------*******--=+*##
##*+**********++=-----:----=++++++**+=-=++++**********++++=----==+*+++++=----------=++*******++==+##
##*+************+=-:------==+++++*+++==+******************==-----+*+++++==-------==+***********=-+##
##*+**************=.:----=+*+++*+++=-+**********************+----+++*+++*+=------+*************+-+**
##*****************#*=-+**+++++*+-=****************************----=++++++**+--*#**************##+..
..=##*********####+.:*#*+*+++++*+-=************######***********+=-=++++++*+*#*:.=####*******##=....
+++**++***###*----:.:*#*+*+++++*+++**********#+------+#**********=-+*+++++*+*#*:.:----*########*+-..
##*++++***#*+=......:*#*+*++++++************++-......-++*********+=+++++++*+*#*:......=+*########+..
##*++++++*#+...   ..:*#*+*++++++**********##:...    ...:*#**********++++++*+*#*:..   ...=########+..
##*++++++*#+...   ..:*#*+*++++++**********##:..      ..:##**********++++++*+*#*:..   ...=########+..
.:=######-.....   ..:*#*+*++++++********#+:...        ...:+#********++++++*+*#*:..   .....-####=....
..:------...      ..:*#*+*++++********#+-:...          ...:-+#********++++*+*#*:..      ...----:... 
...........       ..:+****++++*********=....            ....=*********++++*****:..       .......    
                  .....+#*++++*****##: .                    ..:##*****++++*#+.....                  
                  ..:#######*****#+:..                        ...+####++++++*##:..                  
                  ..:*##########+....                          ....+##++++++*#*:..                  
                  ..:*##########+...                            ...=#*+++++++#*:..                  
                  ..:+*#######**=..                              ..=**+++++++*+:..                  
                   ....+######:..                                  ..:######+....                   
            */














/*

                                                                                                                                                                                                       
@@%%%%%%%%%%%%%%%##*#**==++******++**=--====+#*==---=+++*=--======---======++==-===+++++++++**+++++**+**#**###################%%%#################%###%#**+=+**#%%#+=+=+:=+=====++==--====---=-==+#%#%@
@@%%%%%%%%%%%%%%#*###++++++==+*****+---===+**=+===++*+===-==-==========++*#%#+==++++=+++++++++++++++*****#%%*#%@@@@@######%##%%%%%%%#######*###########**####*###%%#*+=**+-=*+--===+*+==+*#*=*+====-+%@
@%%%%%%%%%%%%%%#*###****+==+******+++===+*#%#+===+==--+##+=-++===----==++-=+====---==++++++++++++++*++**#*****####****%@@@@@%@#%@@@%#****%@@@@@@@@@@@@@@%%#*####%####++**++===-=++=+++-----+++=-=*##*%@
@@%%%%%%%%%%%%%####*****++********+++==###%%#-=++=-===*@@%++#+===-----==-+%%%*=-=++++*%%%%#+====++++%@@@@@@@%**##**+%@@@@@@@@@@@@@@@@++%@@@@@@@@@@@@@@@@@@@%#+++**#%##*#*+===**+=-:====-=++###*#%%%%%%@
@@%%%%%%%%%%%%%%####************+++*#+##%#+=-=**===#*++====*+===-::=#@@#*@@@@*+=*@@@@@@@@@@@%+=====@@@@@@@@@@@@@@+#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#=======*##+=+###*+-:=+***+*#**##%%%%%%%%@
@@%%%%%%%%@%%%%%%%#*****##**++++++=++=+=--+*=-=*==**++++=*@@@*====*@@@@@@@@@@#*%@@@@@@@@@@@@@@@@%*=%@@@@@@@@@@@@@*%@@@@@@@@@@@@@@@@@@@@@%#*@@@%#*++=++=+++##%#+=****+#%#*####*=+****##*+*##%%#%%%%%%%%@
@@%%%%%%%%@%%%%%%%#****###**+***+==++=---=%#+=--=+=+%++=+@@@@@%++%@@@@@@@@@@@#%@@@@%@@@@@@@@@@@@@*-@@@@@@@@@@@@@@%@@@@@@@@@@@@@@@@@@@%##%%#*#+*=====-=+#%@%%%%#+-*##%%########--++=**#*+*#%%%%%%%%%%%%@
@@%%%%%%@@@@%%%@@%#######****+======+==#=---+#%*+%%%%+=+@@@@@@@@@@@%@@@@@@@@@@@@@@%@%%%%%@@@@@@@@#+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%***++*#####**#==##%@@%@%%#*==+#%%%%%=-*+*++=**+**#+*##%%%%%%%%%%%@
@@%%%%%@@@@@%%@@%%####%%%*++====+=*#+-==++=%@@%*#%%%%*%@@@@@@@@@@@%%@@@@@@@@@@@@@@%%%%%%%@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%#+*++##%%%######**#%@@%%@%***-:-#%%%%%#-:-+=*+**++##++##%%%%%%%%%%%@
@@%%%%@@@@@%%%@%%%##%%%#*****++#+*%#=-:#@##@%%%%%%%%+#@@@@@@@@@@@@##%@@@@@@@@@@@@%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%####+*#####%%####+###*#%@@%#%@#***-=*%%%%%%*===++*===+##*+###%%%%%%%%%%@
@@%%%%@@@@%%%@@%%##%%%%#*****++++#%+=-*@%*@%%%%%%%@@%@@@@@@@@@@@%%##%@@@@@@@@@@@@@%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@%@#*@#%@%#*#**#+*###%%####*###*#%@@%*%%%##*=+*%%%%%##*-:=+=:=++*##+*##%%##%%%%%%@
@@%%%%@@@%%%%%@%%#%%%%%#***##*++++++==%@##@%%@@@@@@@@@@@@@@@@@@@#*+#%%@@@@@@@@@@%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@%%%%*%@##%##*#%%###%%%%%%###**+*##@@@%+*%%%%#*=+%@%%%#**=-:=*+:=+***+*##%%##%%%%%%@
@%%%%@@@%%%%%%@@%%%%%##******+*#*+=+#*@@#@@%@@@@@@@@@@@@@@@@@@@@#+*##%%@@@@@@@@%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%#*%#*#*%%%#####%%%*#%#+###*#@@@#+*%%%%%#=+@@%%%##+-:.-**--+###+*##%%%#%%%%%%@
@@%%%@@@%%%%%%@@%%%%###*#*****%@@*=%%%@@@@@@@@@@@@@@@@@@@@@@@@@%*+*#%%@%%%@@@%%%%%%%####%%%@@@@@@@@@@@@@@@@@@###%@%%%%%%###+*#+*%*###%%##%%#*##*###+*%@@@#*%@@#+##++%%%%%#*#=-+=-=--*###=*#%%%##%%%%%%@
@%%%@@@@%%%%%@@@@%%######***+*#@@%=@@@@@@@@@@@@@@@@@@@@@@@@@@%%+=++*%%@%%%@%%%%%#%%#####%%@@@@@@@@@@@@@@@@@@%#%#@%%%#+####+*%#**#%%%#%%%########*##*#@@@@*+%@#*%@%++%%%@#*##=-+++*--+###++##%%#%%%%%%%@
@%%%@@@@%%%%%@@%%%%#####@%##**%@@%*@@%%@@@@@@@@@@@@@@@@@@@@@%*--+==+##%%@@%%%%####***####@@@@@@@@@@@@@@@@@@%+#*##%#==***##+*+#+=++#%%-++--+#*###*#*###@@@#+%@+%@@%=+%%%%#*##+-++*#*-=#%#++##%%%%%#%%%%@
@%%%@@@@@@%%%@@%%%%###*%@##%#*@@@%%%%@@@@@@@@@@@@@@@@@@@@%#+::-=+++=+*##%%%%##%%%#***###%@@@@@@@@@@@@@@@@@@**#*#%%*=##*+**+*+**+#%#%+=++++++--+****%%#@@%#=#%+%@@%#+%%%%++#+=:+=###=:*%%++###%####%%%%@
@%%%@@@@@%%%%@%%@%##*#%#**##**@@%%%@@@@@@@@@@@@@@@@@@@@@@#==+**+***+++**############*##%@@@@@@@@@@@@@@@@@%%%+###%*+#%####*+#%%%%%%@*-===+=+=+++=---=*%@@@#=*%*%@@%+-%%%#*%%#-:++*##*-*%%++###%%##%%%%%@
@%%%@@@%%%#%%@%@@%##*#***#*%#*@@@@@@@@@@@@@@@@@@@@@@#++#%#++**+=*#***++++*########*+*##%@@@@@@@@@@@@@@@@%%%%%%##%*##***+*+#%%%%%@@%==+====++++++=---==-:-*=+%+#@@@*-%%%*@@%*-:*#*+***=%%#+*#*%%#%%%%%%@
@%%%@@@%%%#%%@@@%%*##***@@@@#*@@@@@@@@@@@@@@@@@@@@#=:=++#%##*#%@@@%%#*++++**####****#**@@@@@@@@@@@@@@@@%%%%%%%#*+%%%%##**+#%%%%%%@#=+++**++++++====+++****+==+*%@@*=%%*%@@@*--*###***#%%*=*##%%%%%%%%%@
@%%%@@@@%%%%@@@@%##%##*%@@@@#*@@@@@@@@@@@@@@@@@@%=-..=*##%#*%@@@@@@@%#***++*#####**##*#@@@@@@@@@@@@@@@@%%%%%%%*=*####%%%**%%%%%%%%*=++++****+++--++==-==++**++======%*+@@@@=:=**##****#%*=*##%%%%%%%%%@
@%%%@@@%%#%%%@@@%##%%##@@@@@#*@@@@@@@@@@@@@@@@#+==-==###+#@@@@@@@@@@@@%##*****#*##****%@@@@@@@@@@@@@@@@%%%%%%*#*%%%%%%%%%%%%%%%%%%==++**+==+=-=----:--=++++*+=++-::::-+%@@%-:*#*#####*#%%#+##%%%%%%%%%@
@%%%@@@%%##%%@@%######@@@@@@@@@@@@@@@@@@@@@@#=:=++**#**%@@@@@@@@@@@@@@@%####**####***+#@@@@@@@@@@@@@@@@%%%%%#*%+%%%%%%%%%%%%%%%%%*-+===***+===--:::----=+++**==--:::*+=+%@#::#**#%%##*#%%*###%%%%%%%%%@
@%%%@@@@%%#%@@@%%%%#*@@@@@@@@@@@@@@@@@@@@%#-:-=***##+*@@@@@@@@@@@@@@@@@@%%##*#***####+#@@@@@@@@@@@@@@@%%%%%%+%%%%%%%%%%%%%%%%##%#:====--=-::::::::+*-+-=++++----...-#--*#%#-=###%+***##%#::##%%%%%%%%%@
@%%%@@@@@%%%%@@%#%#**@@@@@@@@@@@@@@@@@@#*+---=+**##+#@@@@@@@@@@@@@@@@@@@@%%###+***#*#+#@@@@@@@@@@%%%@@%%%%%%=%%%%%%%%%###%%%%###=-===---:.::...:=..::++-+*==-=++=-==:==##+=-+%#-+=-#+-%%#=+##**#%%%%%%@
@%%%@@@@%##%%@%#####%@@@@@@@@@@@@@%#+=-=-:::=++****%@@@@@@@@@@@@@@@@@@@@@@%###**#*++*+*@@@@@@@@@@%%#**#%%%%#+%%%%#%%%%%%%%%####+=*++++-:....-:.........===++=--+=::..-+%#*++=+###%###*#%%==###%%%%%%%@@
@%%%@@@%%%%%%@%#####@@@@@@@@@@%%###+-=+:..:-==**#*#@@@@@@@@@@@@@@@@@@@@@@@@%####%#+++=+@@@@@@@@@@%%+#*%%%#%+%%%%%#%%%%##%%#*+*#++***+=--::=.+#:. .....:-=---=+++-:+%=-*#+++++=-=###**%%%%=+#-=%%%%#%%@@
@%%%@@@%%%%%%@%#####@@@@@@@@@%%##*+-==:..:-+++**+*@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%#*+*=+@@@@@@@@@@%=#%*%#*%##%%%%%#%%%%%%%%%%#**=*##*++=+**==%%@%: ......:+-==++=+::+=+#*+=---==---+*###%*=+*+=*#%%%%%@@
@@%%%@@@%%##%@%##%##@@@@@@@@@%#**=:-=---:-==++**+%@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%#**+-#@@@@@@@@@@%=##*%###*#%%%%%%%%%%%%%##*#%+=++**+++*%*=-----:.=..++**==-=++=::-==**+++=---.:::+=+**%#=+#*=+%%%%%%@@
@%%%%%%@%%#%%%%##@%#@@@@@@@@@#***===-:::-==+****=@@@@@@@@@@@@@@@@@@@@@@@@@@@%@%%%##+=+@@@@@@@@@@@%=#+@%###*###%%%%%#%%%%%#**##-===+=+#*+%%*++-.:+%%::=#@%-=====-::::=*=----:.:..-*-=*+-#%*=-*#%%%%%%%@@
@@%%%%%%%%%%%%%*%@%#@@@@@@%%%#**=-=--:::-=*++***=%@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%###++@@@@@@@@@@@@%**@@%*##*##*######%#####%%#-===+=-:++=+==.=-..-=#-:.-:-:+*-+====++**+==:... -+-:-=#+#%#===*%%%%%%%%@@
@%%%%%%@%%%%%%%#@@@%@@@@@@%%%#**=+=--::-==++*****%@@@%%%@%%%%%%%@@%%%@@@@@%%@@%##%%@@@@@@@@@@@@@@@@@@+%*##*#*#######*##******:+=+=:....==++#+-.-::::-*+-:-+*--==+==*#*+=-.... ...=*##*=##++*#%%%%%%%%%@
@%%%%%%@@%######@@@@@@@%%%%%%#**+++--::-=++*####*+*#%%#+*%%#%##%%%%%%%%%%%%@%%#*@@@@@@@@@@@@@@@@@@@@#+*+++=++#**+***#*##****=+*##*-=....:+*%=-=-::-++==+#%#+--==+****+++=+=-..+#==##**==%#+*##%%%%%%%%@
@@%%%%%@@%###%*%@@@@@@@@%%%%%%##+++==--=++**##**+++*#*+=-#%##############*%%####@@@@@@@@@@@@@@@@@@@@*+++++++=+***+++=**++**+==+#%%#===:..--+#**+#+++*%++*+++--=*****=-:..-==-:=++#*+++++*#+#%%%%%%%%%%@
@@%%%%%@@%%##%*@@@@@@@@@@@%%%%##***=++=++**###*+++++*+==-*#######******#*%%#****@@@@@@@@@@@@@@@@@@@@+=+++*++===+===+++++=+*+-==+*%%++*++=-:.-=*##++##**+=++*=-=++**+=-:....:=+=-+++=-:-==++#%%%%%%%%%%@
@@%@%%%@@%%%*%*@@@@@@@@@@@@@%%#####*+++**########*+**++-=%##**##*+++++++#*+++++*@@@@@@@@@@@@@@@@@@@@+-+*++++++==-=-=+***++*==--=++#%#=**-:....++*+=+***=#%++-++++**+==:.....-+*#*#+:*%#:.===#%%%##%%%%@
@@@@@%%@%%%#*%*@@@@@@@@@@@@@@@%######***##*#***+=+++-=+*%#+*****+=-====**=-==+++%@@@@@@@@@@@@@@@@@@@=++==+++++**+*+******++=*%+-=++*%%***+=.....=*--==-=##=::==++**=-=+-.:-:-+*=-+++#*=...-=-+%%%%%%%%@
@@@@@%%%%%%#*%*@@@@@@@@@@@@@@@@%######*+++**############*+++****=------++::-==++*#%@@@@@@@@@@@@@@@@%=++=++++++=+*+=++-===+-:+#*=--=+*#%*+*=--:.:..-----===:-+++***++--::::==**+-.::-*+..:.====*%%%%%%@@
@@%@@@%%%%%%*#*@@@@@@@@@@@@@@@@@@@%%%#=..-*##**+==*****+++++***+++=:--=**====+==+%@@@@@@@@@@@%#%@@@%=+*++*+*=+*+===+=-=#*-++:-=:-=++*##*+*+=+++---==----=++++*****+*+-:.:--+*+=+=..:##:.=+***+%@@@@@%@@
@@%@@@@%%%@%%#@@@@@@@@%%@@@@@@@@@@%####-..:-+++*++++*****+=-=++--++====###*##*-::=%@@@@@@@%%%*=-=+*#+++**+++++++-:::=%@@@+=++**++++++++=+=-:..:-=-.=+++++==--==-=++++--:--+*%%%+=-=-...:=+*+*%@@@@@%%%@
@@%%@@@@%%%@%*@@@@@@@@%%@@@@@@@@%@#+===:.:=...:==:-+++#**+-.:==:..=++*@@%*=:.=#@@=#@@@@@@%+==:...::-=+=+*++-.:-:....:#@@=.:=-:+*+=-::--:::.......-.-+*+---.......-+++===-=#####+==---+#*-=*##*#@@@@%%%@
@@%%%@@@%%%%@*#@@@@@@%%@@@@@@@@@%#+==:=%@@@...+@@@*=:-+*+=-.+@@@*..-%@@%+-=@@@@@@*@@@@@@%+:..-#@@@=:-:=+*#+:.-=+*#%@@@@@@@@@%-+++-.+@@+..+%@@@@@=-:-++--::+%@@@@%+:-+++***++%%=-::=-----**++#*+%@@@@@@@
@@%%%@@@%%%%%%*@@@@@%%%@@@@@@@@@@#==%@@@@@@@#*%@@@=..:**=+#*%@@@@@+-+#@%*##@@@@@@*%@@@@@@+-*##@@@@@%:.:*##*+****%@@%##*+==-...=--#@@@@@%#*#@@@@@*===--=*%*###%@@@@@%+++**=:-++==-====+*%#*+==+++%@@@@@@
@@%%%%@@%%#%%%*%%%@%%%@@@@@@@%%%@@%**+=@@@@:..=@@@@%+.:+#+++==@@@@@*:+#@@@%*%@@@@=#@@@@@@%*-+*=*@@@@%..+#%%##+-*@@+=*#+--......:+#@@@@*.....#@@-=++-=%@#++++++*#@@@@@==*+=-::::-===+***%%%#+:-+++%@@@@@
@@%%%%%@%%###**%%%%%%%@@@@@%%%%%@@%%%%#@@@@#%@@@@@@@@@=-***+==@@@@@@+.-*%@@*%@@@@-+%@@@@@#+=-::+@@@@@@:=**###=%@@#.-**=-:=#%%*.-*+#@@@+....*@@:..--*@@@-+***+=++*@@@@#=++=-::::=+**+=+#*#%#-..-:+*%@@@@
@@%%%##%%%###*+#%%%%#%@@@@@@%%%@#++#%%+%@@@=-:::=%@@@@#++=-+%%##@@@@@=:=#@%=*@@@@*%**%%@%+-.-%%##@@@@@%-:=**=#@@@*:-*=#%#*#@@@%**=*@@@#-+%@@@@@@+.-@@@%-+***=::-:#@@@#=+++==-==+*#+--:::=+:..:-==+#@@@@
@@%%%%#%%%%###*+#%%%%%@@@@@@@@@#+*#*=+-%@@@----=++#@@@=.:%@%:-=:*@@@@@+-#@%=+@@@@-----=++-*@%:...-@@@@@#..=+=@@@@%::-+*##*=*@@@+==*@@@%+**=#@@@@@*+@@@@+=+*+-....*@@@#+++++++*###*::.:..--:--.=**+*@@@@
@@%%%%%%%%%%#%#%*+%%%%@@@@@@@@@###*++*+@@@%....:--*@@=-+@@@%::---@@@@@@--*%*#@@@@..:.....#@@@-....+@@@@@*..=+%@@@@%...-=+++#@@+=--#@@@*=#%%#*@@@@%=@@@@%=-:.....-@@@=+=**+**###*+-:....-*%*-*#+=*%@@@@@
@@@@%%%%%%%#####%#+#%@@@@@@@@%%*%%##%*+@@@@#=:::=##==+*#@@@@@%##++*@@@@@*=+#@@@@@*++++++=%@@@@@##*++%@@@@%++%%@@@@@@%+---+%@#==**=#@@@+*%%%%##@@@@.#@@@@@%*-::=#@*==+==+****+*==+=:.:-===++*##%#@@@@@@@
@@@@@@@%%%%####*#%#*=#@@@@@@@%*+***%%++%@@@@@@@%+=++-+**+%@@#++*#*=*@@@%*+%*#@@@@@@@@@@#--*@@%*++*#*=#@@@%*#%%*+#@@@@@@@#*+*%+*#%**@@*+**#%%#*@@%*+=+%@@@@@@@%#++**=++***++++++=+++++++*#%%%####@@@@@@@
@@@@@@@%%%%%##%####*#+*@@@@@@%##+-+*%#*#+==+=-:==#***#%*++*#*####+-#*##%@@@@%##******+#%@@%#*%#*#%#+**++***###*##**+****#%@@*:##*+====##***#%#**##=##*+=---=+++*##*****#*++++***+*#####*#*##***%@@@@@@@
@@@@@@@@@@%%%%%###**+*+==#%#**#%==+#=:-#%#%%-.:=-#-:+*####%%#*###=+@@@@@@@@@@@%%%@@%@@@@@@@@%%#*##+#####%%%%%%%++%%##%%%@%%%#:*#**=-+.+#*++*#%%##%#=**=:....+***#****++#*****##*****++=-=++****%@@@@@@@
@@@@@@@@@@@%#%%%##**++++++=#*++#%##*:-+:.-=%*=++#:.-#*%**##%####+=%@@@@@@@@@@%%%%%%%%@@@@@@%#%%**%=*#*+**##*%%##%##+*#%%%%%%%%=*#**---:+##*++#%%##%%+**=:...+####*##+++***##%%#++++=+==:-=**+**#%%%@@@@
@@@@@@@@@@@@%#%%##%#*++++++*#****=+#*+-.:=##*#%%*==****=***%##+*=:@@@@@@@@@@@%%%%%@%%@@@@@@%#+%*#**#++#*#%%*#%%##%%%%##%%%%%%%%*+*#+=:..=##*=*#%%#%%#+**=...:***###***##**+++**+=====-:=:-+++*#%%%%%%@@
@@%@@%%%%%@%%%%%%%###*+**+=+*=+#**#=+*==**#..=+#%##+=#+*#+#+*#-*+:@@@@@@@@@@%%%%%%%%%@@@@@%#*+#*#=##*******###%#*%%%%%%#*#%%%%%###+**+-..:*#*+=*#%####=+*-...+######*+**+**++*+=-:::+-*+==+++*%%%%%##%@
@%%%@@%%%%%@%%%#%%%%#*++++=++++==*+=*##***=:=+*#+##%%%##**#*#*=#-*@@@@@@@@@%@%%%%%%%@@@%@%%#*-=*#=*###*=*##+##*###%%%%%%%%%##%%%%%%#=#*=...*%#+=+*%####+#+-..:###%#+==+****++=-:=-.-=::+*++**#%%#%#*#%@
@%%%%%@@%%@@@%##%%%%%###*+=-===++==++*#+=****%*+**+%%%##%%##*+#++@@@@@@@@@@@%%%%@@@@@@%####**=%#+***+*##++**#*+*#######%%#%#%###%%%%%#*#*=:.:*#*+=*####+**-::.-*+*==+***#*====--+-==:==+*****#####%%#%@
@%##%%%%%@@@@%%%%%%%#####%#++==-=++++*+=+#%####**#%%*##*+##+##*+%@@@@@@@@@@@%%%@@@@@%@#*+##**+%#*#**##**####+*+###*##*#####*###*+*##%*#++#*=.:+##*=+*##*+*=::::-+*+*+=+****=++===**==+=+***#*#####%%%%@
@%#%%%%%%%@@@@%%%%%%##%%%#%@%*++====**+**##++%%%%%%%#%**##+:*-#@@@@@@@@@@@@@%%@@@@%%%#=+*#*+*%%%##%##*#*=*+*##+**####*####*-+#+*#*+**=**#=*#=::-+#+==+#*+#*-=:...+++++*##++===+====+**++**###%#%%%%##%@
@%%%%%%%%%@@@@@%%%%%%%%%%#%%%%#+=-===*=*##*##%%%#*#%%###*+=++%@@@@@@@@@@@@@@@@@@@@%#*+*+#*+*+%%%#%#%%%#**##**##**#*****+****************#+=*#+:.:=*++++**##+-+:..:+*++*##*===+*+**+***+***########%###@
@%%%%%%%%%%@@@@@@%%%%%%%%##%%%#+*---====+*###%%#*%%%%##***#@@@@@@@@@@@@@@@@@@@@@@@%+*%%%%**#%%%%%###%%%*++#####*#*#****##*++*#*+=+++***+***+=**+--::-**#*%#*+-:::.:+***##*=+*#*+**+*###**###++*#%%%##%@
@@%##***####%%%@@@%%%%%%###%@%%%#*+======**#%%##%%%%%*=#@@@@@@@@@@@@@@@@@@@@@@%#%##=%%@%%+#%%%%%%%%%@@%%%%%*+****#++#*+###+=***++#*##+**=+*++=*#+:.-::+#*###+=--::=+#*####*##%###**########*+==-::+*#%@
@@%###%%%%###%%%%%%%%%%%%###%%%%#***+======*%%#######@@@@@@@@@@@@@@@@@@@@@@@@%*###**%%%%%*%%%%%%%%%%%%%%%%%%##%##*#%%#**++*+**+=****#+***+*##*=##*=--:-*#*%#**+++++==+######%%##*####%%%#####%#%###%%%@
@@%@@@@@@@@@@@@@@@@@@@@@@@%%###*###****=--==*%%####@@@@@@@@@@@@@@@@@@@@@@@@@@*#%#*+####%#*#%%%%#%%%##%%%#%#+#*+#****#*#%*==**+++*#%#****+**+*#*-*#*+++=*%#%%##*##-....:*#%#%%%###*###%######%##*#%##%%@
@%##%%%%%%%%@@@@@@@@@@@@@@@@@%%%##****=++-===#%####@@@@@@@@@@@@@@@@@@@@@@@@*#*%#++*%####%#%%%%%@%%%%#%##%#%%##%%##%%%#*##*#**-+*****##+=++++**#*==***+-==++--#*+=.....:-*#####%%%%%%%%#####%%%%%%%%%%%@
@%%%%%%%###***####%@@@@@@@@@@@@@%%####*=++++==###*#@@@@@@@@@@@@@@@@@@@@@@@%*%%#+%+##%%%%##%####**%%%%##%###%%%##%#**###**#***#*****++******#*##*###*=-++*#+==*#*==::-::==##%%%%%%%%%%%%%%%%%#%%%%%%%%%@
@@@%%@%%%%%##%%%%%%%%%%@%@@@@@@@@@@%%##*+=+++**##*+@@@@@@@@@@@@@@@@@@@@@@@%*%%*#%#*%#####%%##%%%#%#+#%##%%########%%%%#######%######*****##***+*#%*++=#++#===#*#***+==+++#*+##%%#%%%%%###%###%%%#####%@
@@@@@@@%%%%###**********++***##%%%%%%%%%#**+==***++@@@@@@@@@@@@@@@@@@@@@@@##%#+*##%%%##%%%%%%#%%#%#**++#%#########%####%%%%%###%%%##*##%###++*##%@*++=:-+*++**##%##****+**#####%#%##%%###%#%#######%#%@
@@@@@%%%#**********#######%%%%%%%###%%%%%%#*+=***=*@@@@@@@@@@@@@@@@@@@@@*@*%%##%%%%%%%%%%#%#####**+#######*#########*#%%##%#**%##%%%######%@#**#@@%-++***#*#####=-=--=+****#########%%%%#%%%###**##%%%@
@@@@@%#**#############%%%%%%%%%%%%%%%%%%%%%#**+*+=@@@@@@@@@@@@@@@@@@@@@#+#*%%+#%%%%%%%%%%%%##%%#+*####*#############*=++*#%%%%%###%####**#*####@@@@#+=*###%%%%#====-:-=+#**#########%%#*##%###****###%@
@@@%%#######%%#%%#%%%%%%%%%%%###********#%%%%%##**#%@@@@@@@@@@@@@@@@@@%*%=%@%*@@%@@@@@%%%#%%%#%#%###%%%#%%#####%###***#########%%%%#*#####*=##%@@@@@@@*===*#%%==++-..:==**++***####*#%#####**#*+#####%@
@@@@@%%@@@@%%%%%%%%%%%%#####****+++++**###***###%%#+=#@@@@@@@@@@@@@@@@**%#%@@@%%%@@@@@@@@@%%%%%%%%%%%%%#%#####%%%%%%%###**#####%%%%##%###*#*#%@@@@@@@%:-=+**%*-+==-..:=+*%*++*****#########****####**#@
@@@@@@@@@@@%%%%%%%%#**********#*##*###%%%%##%%%%%%%%%%#*+#%%%@@@@@@@@#*#@@@@@@@@@@@@@@@@@#%@@%%%%%%%%%%%%%%%%%%%%##%%%#*+*#%%%%%%###%%%%%###%@@@@@@%%#.-=**#%=++=-...-++#%%###*##***#*#########**#*##%@
@@@@@@@%%%%%%%%##****##############%%%%%%%%###********###%%%#*#%%@@%#*##@@@@@%%%@@@@@@@@@@@@@@@@%##%%%%%#%#%%%#%%%%%%%%##%###*%%%%%%%%%%%%@@@@@@@@@@%+:==+*#%-++=:...+*+##%%%%#*+*#####%%%%%%####*####@
@@@@@@@@%%##********##########%%%%%%%%#*+++++===+**#*++*###%%@@@#+=#%@@%@@@@@@%@@@@%%@@@@@@@@@@@@@@@@@@@@%%%%%%%%@@@@@@%%%%%%#####%%%%@@@@@@@@@@@@@@@=-=+*##=++=-.:-=**#*+***+**##*+###*#%%%%%%%#####%@
@@@@@@@%%#################%%%%%%%%#**++++++++++***#**##%%%@@@@@@@@%+#%@@@@@@@%%%@@@%%@@@@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%##%%%#%@%@@@@@@@@@@@@@@@@---=+##++=-...:**#######***+*++#%%%#*++=+*#***#%%@
@@@@@@@@@@%%%%%%%%%%####%%%%%##*+++++==+*********##%%%%@@@@@@@@@@%%%*****##**##%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@--++*#++*=:..-=#**+#%%%##***#+++**%%%%#*****####%@
@@@@@@@@@@@@@%%%%%%%%#%%%#**+++++==++++***########%%%%%%@%%%######***##%%%%%%%#*++*#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%:=+*##=+=:..-=*+##*++*%%##%%%%##****##%@%%##%###%@
@@@@@@@@@@@@@@@@%%%%##*++++++**++******####%%%%%%%%%%%##*********#**####%%%###%%%%#+-#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#-++*#+++-:..-=+%@%%#**#%%%%##%%%####****#%@@%%%%@@
@@@@@@@@@%%%%###****+***+++++********######%%%%%%###*+++==++++++**###%%@@@@@%%%%%%@@%***###%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%+-==++==+=---+*#@@@%%#*#%%%+*#*+**#*########%#%@@@@
@@%@%%%%%%#####******++++++****###*######%%%##*+++++=====++++++**##%%%%@@@%%###%%%%%%####**+==#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#+==++++=====+++++%@@@@@%%%%%%##%%%%%%%#++#*-+%%%%@@@@
@@@%%%%%%############****########***######***++*+++++++**+***####%%%%%%#*++*#%@@%%%%%%%%#%%%%%#*#%@@@@%@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*==++++***+++++=+=+#@@@@@@@@%%%%%%%%##%%%%#**%@@@@@@@@@@
@@@@@@%%%###############%%%###########*++===+++====++++++***####%%%#*+==+*#%%%%@@@@@@@@@@@@%%#%%*+*%@@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%++=*####*****+===+++==%@@@@@@%%%@@@@@@@@@%%%%%%@@@@@@@@@@@
@@@@@@@@@%%%%%%%%######%%%%#######*+++==========++++****+*#######*+==++*#%%%%@@@@@@@@@%%%%%%%#*++++*%%%%%%%@@%@%@@@@@@@@@@@@@@@@@@@@%%@@@@%+=*#%%#%%%%%%%%%%*==+##**@@@@@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@%@%%%%%%%%%%%####*+====++=======++++*******######*+=+++**#%%%%%%%%%%%%%%%%%%%%%%%%%%#===*%%%#%###%@%%%@@@@@@@@@@@@@@@@%@@@%#*##%%@@@@@@@@@%@@@@@%##%@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
*/